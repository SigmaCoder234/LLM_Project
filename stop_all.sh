#!/bin/bash
# =============================================================================
# üõë TeleGuard Bot v3.0 - –£–ú–ù–´–ô –°–¢–û–ü–ï–†
# =============================================================================

echo "================================================================================="
echo "üõë TeleGuard Bot v3.0 - –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤"
echo "================================================================================="

# 1. –ß–ò–¢–ê–ï–ú PID'—ã –ò–ó –§–ê–ô–õ–ê (–µ—Å–ª–∏ –µ—Å—Ç—å)
if [ -f ".tele_pids" ]; then
    mapfile -t PIDS < .tele_pids
    echo "üìã –ù–∞–π–¥–µ–Ω—ã —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ PID'—ã: ${PIDS[*]}"
fi

# 2. –£–ë–ò–í–ê–ï–ú –í–°–ï –ü–†–û–¶–ï–°–°–´
echo "üî™ –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –ø—Ä–æ—Ü–µ—Å—Å—ã..."
pkill -9 -f "python3.*agent" 2>/dev/null || true
pkill -9 -f "python3.*teleguard_bot" 2>/dev/null || true
pkill -9 -f "uvicorn" 2>/dev/null || true

# 3. –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–ê–Ø –ü–†–û–í–ï–†–ö–ê
sleep 2
echo "üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Å—Ç–∞—Ç–æ—á–Ω—ã—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤..."
ps aux | grep python3 | grep -E "(agent|teleguard_bot)" | grep -v grep || echo "‚úÖ –í—Å–µ –ø—Ä–æ—Ü–µ—Å—Å—ã –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã"

# 4. –û–ß–ò–°–¢–ö–ê
rm -f .tele_pids

echo ""
echo "‚úÖ ‚úÖ ‚úÖ –í–°–ï –ö–û–ú–ü–û–ù–ï–ù–¢–´ –û–°–¢–ê–ù–û–í–õ–ï–ù–´ ‚úÖ ‚úÖ ‚úÖ"
echo "================================================================================="
